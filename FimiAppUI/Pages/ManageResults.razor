@page "/Pages/ManageResults"

@inherits ManageResultsBase

<PageTitle>Results</PageTitle>

<MudGrid Class="mt-n16 px-5" Style="@($"background:#ffffff;")">
    <MudItem xs="9">
        <MudText Typo="Typo.h5" Class="d-flex pt-2 justify-start"><b>Manage Results</b></MudText>
    </MudItem>
    <MudItem xs="3" Class="d-flex justify-end">
        <MudIconButton Icon="@Icons.Material.Filled.Message" Color="Color.Inherit" Edge="Edge.End" />
        <MudIconButton Icon="@Icons.Material.Filled.Notifications" Color="Color.Inherit" Edge="Edge.End" />
    </MudItem>
</MudGrid>


<MudGrid Class="d-flex px-4 mt-4 align-center">
    <MudItem xs="2">
        <MudCard Elevation="0">
            <MudCardContent>
                <MudAutocomplete T="TermModel" Label="Term" @bind-Value="SelectedTerm" ShowProgressIndicator="true"
                                 SearchFunc="@SelectedTermSearch" ToStringFunc="@(e=> e==null?null : $"{e.TermName}")" />
            </MudCardContent>
        </MudCard>
    </MudItem>
    <MudItem xs="2">
        <MudCard Elevation="0">
            <MudCardContent>
                <MudAutocomplete T="ExamTypeModel" Label="Exam Type" @bind-Value="SelectedExamType" ShowProgressIndicator="true"
                                 SearchFunc="@SelectedExamTypeSearch" ToStringFunc="@(e=> e==null?null : $"{e.ExamName}")" />
            </MudCardContent>
        </MudCard>
    </MudItem>
    <MudItem xs="2">
        <MudCard Elevation="0">
            <MudCardContent>
                <MudAutocomplete T="FormModel" Label="Form" @bind-Value="SelectedForm" ShowProgressIndicator="true"
                                 SearchFunc="@SelectedFormSearch" ToStringFunc="@(e=> e==null?null : $"{e.Form}")" />
            </MudCardContent>
        </MudCard>
    </MudItem>
    <MudItem xs="2">
        <MudCard Elevation="0">
            <MudCardContent>
                <MudAutocomplete T="StreamModel" Label="Stream" @bind-Value="SelectedStream" ShowProgressIndicator="true"
                                 SearchFunc="@SelectedStreamSearch" ToStringFunc="@(e=> e==null?null : $"{e.Stream}")" />
            </MudCardContent>
        </MudCard>
    </MudItem>
    <MudItem xs="2">
        <MudButton Variant="Variant.Filled" FullWidth="true" OnClick="@FindClass" StartIcon="@Icons.Material.Filled.Save" Color="Color.Primary" Style="background-color:#DA4167">Submit</MudButton>
    </MudItem>
</MudGrid>
<MudDivider DividerType="DividerType.FullWidth" Class="my-6" />

<MudGrid Class="d-flex justify-start px-4">
    <MudItem xs="12">
        @if (StudentsSubjectPerformance is null && visible is true)
        {
            <MudProgressLinear Color="Color.Tertiary" Size="Size.Small" Indeterminate="true" Class="mt-4" />
        }
        else 
        {
            <MudTable Bordered="true" Elevation="0" Items="@StudentsSubjectPerformance" Dense="true" FixedHeader="true" Hover="true" SortLabel="Sort By" Striped="true" CanCancelEdit="true"
                      @bind-SelectedItem="SelectedItem" CommitEditTooltip="Submit" OnCommitEditClick="ItemHasBeenCommitted" RowEditPreview="BackupItem" 
                      RowEditCancel="ResetItemToOriginalValues" IsEditRowSwitchingBlocked="true"ApplyButtonPosition="TableApplyButtonPosition.StartAndEnd" 
                      EditButtonPosition="TableEditButtonPosition.StartAndEnd" EditTrigger="TableEditTrigger.EditButton">
                <HeaderContent>
                    <MudTh Style="font-size:12px;">#</MudTh>
                    <MudTh Style="font-size:12px;"><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<ClassPerformanceModel, object>(x=>x.StudentNumber)">Student Number</MudTableSortLabel></MudTh>
                    <MudTh Style="font-size:12px;"><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<ClassPerformanceModel, object>(x=>x.FirstName)">Name</MudTableSortLabel></MudTh>
                    <MudTh Style="font-size:12px;">English</MudTh>
                    <MudTh Style="font-size:12px;">Kiswahili</MudTh>
                    <MudTh Style="font-size:12px;">Mathematics</MudTh>
                    <MudTh Style="font-size:12px;">Physics</MudTh>
                    <MudTh Style="font-size:12px;">Chemistry</MudTh>
                    <MudTh Style="font-size:12px;">Biology</MudTh>
                    <MudTh Style="font-size:12px;">History & Government</MudTh>
                    <MudTh Style="font-size:12px;">Geography</MudTh>
                    <MudTh Style="font-size:12px;">Christian Religion</MudTh>
                    <MudTh Style="font-size:12px;">Home Science</MudTh>
                    <MudTh Style="font-size:12px;">Agriculture</MudTh>
                    <MudTh Style="font-size:12px;">Business Studies</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd Style="font-size:12px;" DataLabel="Student Number">@context.Index</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Student Number">@context.StudentNumber</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Name">@context.FirstName @context.MiddleName @context.Surname</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="English">@context.English.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Kiswahili">@context.Kiswahili.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Mathematics">@context.Mathematics.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Physics">@context.Physics.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Chemistry">@context.Chemistry.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Biology">@context.Biology.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="HistoryAndGoverment">@context.HistoryAndGoverment.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Geography">@context.Geography.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="ChristianReligion">@context.ChristianReligion.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="HomeScience">@context.HomeScience.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="Agriculture">@context.Agriculture.ToString("0.00")</MudTd>
                    <MudTd Style="font-size:12px;" DataLabel="BusinessStudies">@context.BusinessStudies.ToString("0.00")</MudTd>
                </RowTemplate>
                <RowEditingTemplate>
                    <MudTd DataLabel="Student Number"><b>@context.StudentNumber</b></MudTd>
                    <MudTd DataLabel="Name"><b>@context.FirstName @context.MiddleName @context.Surname</b></MudTd>
                    <MudTd DataLabel="English">
                        <MudNumericField T="double" @bind-Value="@context.English" Required HideSpinButtons="true" Style="font-weight:700;" />
                    </MudTd>
                    <MudTd DataLabel="Kiswahili">
                        <MudNumericField T="double" @bind-Value="@context.Kiswahili" Required HideSpinButtons="true" Style="font-weight:700;" />
                    </MudTd>
                    <MudTd DataLabel="Mathematics">
                        <MudNumericField T="double" @bind-Value="@context.Mathematics" Required HideSpinButtons="true" Style="font-weight:700;"/>
                    </MudTd>
                    <MudTd DataLabel="Physics">
                         <MudNumericField T="double" @bind-Value="@context.Physics" Required HideSpinButtons="true" Style="font-weight:700;"/>
                    </MudTd>
                    <MudTd DataLabel="Chemistry">
                         <MudNumericField T="double" @bind-Value="@context.Chemistry" Required HideSpinButtons="true" Style="font-weight:700;"/>
                    </MudTd>
                    <MudTd DataLabel="Biology">
                         <MudNumericField T="double" @bind-Value="@context.Biology" Required HideSpinButtons="true" Style="font-weight:700;"/>
                    </MudTd>
                    <MudTd DataLabel="HistoryAndGoverment">
                         <MudNumericField T="double" @bind-Value="@context.HistoryAndGoverment" Required HideSpinButtons="true" Style="font-weight:700;"/>
                    </MudTd>
                    <MudTd DataLabel="Geography">
                         <MudNumericField T="double" @bind-Value="@context.Geography" Required HideSpinButtons="true" Style="font-weight:700;"/>
                    </MudTd>
                    <MudTd DataLabel="ChristianReligion">
                         <MudNumericField T="double" @bind-Value="@context.ChristianReligion" Required HideSpinButtons="true" Style="font-weight:700;" />
                    </MudTd>
                    <MudTd DataLabel="HomeScience">
                         <MudNumericField T="double" @bind-Value="@context.HomeScience" Required HideSpinButtons="true" Style="font-weight:700;" />
                    </MudTd>
                    <MudTd DataLabel="Agriculture">
                         <MudNumericField T="double" @bind-Value="@context.Agriculture" Required HideSpinButtons="true" Style="font-weight:700;" />
                    </MudTd>
                    <MudTd DataLabel="BusinessStudies">
                         <MudNumericField T="double" @bind-Value="@context.BusinessStudies" Required HideSpinButtons="true" Style="font-weight:700;"/>
                    </MudTd>
                </RowEditingTemplate>
                <PagerContent>
                    <MudTablePager/>
                </PagerContent>
                <EditButtonContent Context="button">
                    <MudIconButton Size="@Size.Small" Icon="@Icons.Material.Outlined.Edit" Class="pa-0" OnClick="@button.ButtonAction" Disabled="@button.ButtonDisabled" />
                </EditButtonContent>
            </MudTable>
        }
    </MudItem>
</MudGrid>


    
        
